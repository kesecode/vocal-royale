services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    image: vocal-royale-backend
    container_name: vocal-royale-backend
    env_file:
      - compose.env
    ports:
      # Map host BACKEND_PORT â†’ container 8080 (PocketBase)
      - "${BACKEND_PORT:-8090}:8090"
    volumes:
      # Persist PocketBase data on the host
      - pb_data:/pb/pb_data
    restart: unless-stopped

  app:
    build:
      context: ./app
      dockerfile: Dockerfile
    image: vocal-royale-app
    container_name: vocal-royale-app
    env_file:
      - compose.env
    ports:
      - "${APP_PORT:-3000}:3000"
    depends_on:
      - backend
    restart: unless-stopped

volumes:
  pb_data: